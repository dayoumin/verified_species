와우, 프로젝트에 대한 구체적인 아이디어와 계획이 많으시네요! 

아주 좋습니다. 요청하신 내용들을 하나씩 살펴보고 답변 및 자료를 제공해 드리겠습니다.

**1. 위키피디아 정보 추가**

* **아이디어**: 매우 좋은 생각입니다! WoRMS에서 얻은 분류학적 정보에 더해 위키피디아의 생물종 설명을 함께 제공하면 사용자에게 훨씬 풍부한 정보를 전달할 수 있습니다.
* **구현**: 파이썬의 `wikipedia` 라이브러리를 사용하면 학명을 키워드로 위키피디아에서 관련 페이지를 검색하고 요약 정보를 가져올 수 있습니다. `pip install wikipedia`로 설치하고, WoRMS 정보 조회 후 해당 학명으로 위키피디아 검색 로직을 추가하면 됩니다. 이 정보 역시 Gemini를 통해 자연스럽게 가공하거나, Supabase에 함께 저장할 수 있습니다.
* **제안**: 현재는 WoRMS + Gemini + Supabase 연동에 집중하고, 위키피디아 연동은 다음 단계의 기능 확장으로 고려해보는 것이 어떨까요? 단계적으로 기능을 추가하는 것이 학습과 개발 관리에 더 용이할 수 있습니다.

**2. LangGraph 사용 여부**

* **LangGraph**: 여러 AI 모델 호출, 외부 도구(API 등) 사용, 상태 관리 등을 조합하여 복잡한 AI 에이전트나 워크플로우를 만들 때 유용한 프레임워크입니다.
* **현재 상황**: 지금 만들고 있는 스크립트는 WoRMS API 호출 -> (선택적) Supabase 조회/저장 -> Gemini API 호출의 비교적 직선적인 흐름을 가지고 있습니다. 이 정도 수준에서는 LangGraph를 반드시 도입할 필요는 없어 보입니다. 오히려 초기 단계에서는 불필요한 복잡성을 더할 수 있습니다.
* **결론**: **현재로서는 LangGraph 도입은 필수가 아닙니다.** 나중에 기능이 훨씬 복잡해져서 여러 정보 소스를 동적으로 조합하거나, 사용자와의 대화 흐름을 관리해야 하는 등의 요구사항이 생기면 그때 도입을 고려해볼 수 있습니다.

**3. FastAPI, Flutter 기반 PRD 문서**

요청하신 대로, FastAPI 백엔드와 Flutter 프론트엔드를 사용하는 '학명 정보 조회 서비스'의 기본적인 PRD(Product Requirements Document) 초안을 만들어 보았습니다.

---

**학명 정보 조회 서비스 - 제품 요구사항 문서 (PRD) 초안**

**1. 개요**

* 본 문서는 사용자가 입력한 학명(Scientific Name)에 대한 유효성, 분류 정보, 관련 설명을 제공하는 서비스의 요구사항을 정의합니다.
* 백엔드는 FastAPI(Python)로 구현하며, WoRMS API, (선택적) Wikipedia API, Gemini API를 연동하고 Supabase를 데이터 캐싱/저장소로 활용합니다.
* 프론트엔드는 Flutter를 사용하여 모바일 및 웹 애플리케이션 형태로 사용자 인터페이스를 제공합니다.

**2. 목표**

* 사용자가 학명을 입력하면 해당 학명의 최신 유효성 및 분류 정보를 쉽고 빠르게 확인할 수 있도록 한다.
* WoRMS의 전문적인 정보와 Gemini의 자연어 설명을 결합하여 사용자 친화적인 정보를 제공한다.
* Supabase 캐싱을 통해 반복적인 API 호출을 줄여 비용을 절감하고 응답 속도를 개선한다.
* (확장 목표) 위키피디아 정보를 연동하여 생물종에 대한 추가적인 설명을 제공한다.

**3. 사용자**

* 생물학 연구자, 학생
* 수산, 해양 관련 종사자
* 생물 분류 및 학명에 관심 있는 일반 사용자

**4. 기능 요구사항**

* **FR-01: 학명 입력**: 사용자는 앱/웹 화면에서 학명을 텍스트로 입력할 수 있어야 한다.
* **FR-02: 정보 조회 요청 (Flutter -> FastAPI)**: 사용자가 '조회' 버튼을 누르면 Flutter 앱은 입력된 학명을 FastAPI 백엔드로 전송해야 한다.
* **FR-03: Supabase 캐시 확인 (FastAPI)**: 백엔드는 요청받은 학명이 Supabase 캐시에 있는지 확인해야 한다.
  * 캐시에 유효한(예: 특정 기간 내) 데이터가 있으면 해당 데이터를 반환한다.
* **FR-04: WoRMS 정보 조회 (FastAPI)**: 캐시에 데이터가 없거나 오래된 경우, 백엔드는 WoRMS API를 호출하여 AphiaID 및 상세 정보를 조회해야 한다.
* **FR-05: (선택) Wikipedia 정보 조회 (FastAPI)**: WoRMS 정보 조회 후, 해당 학명으로 Wikipedia API를 호출하여 관련 요약 정보를 조회할 수 있다.
* **FR-06: Gemini 정보 가공 (FastAPI)**: 조회된 정보(WoRMS, Wikipedia)를 바탕으로 Gemini API를 호출하여 사용자 친화적인 한국어 설명을 생성해야 한다.
* **FR-07: Supabase 캐시 저장/업데이트 (FastAPI)**: 새로 조회/생성된 정보를 Supabase에 저장하거나 업데이트해야 한다 (마지막 조회 시간 포함).
* **FR-08: 결과 반환 (FastAPI -> Flutter)**: 가공된 최종 정보(Gemini 설명, WoRMS 링크 등)를 JSON 형태로 Flutter 앱에 반환해야 한다.
* **FR-09: 결과 표시 (Flutter)**: Flutter 앱은 백엔드로부터 받은 정보를 사용자 화면에 명확하고 보기 좋게 표시해야 한다.
* **FR-10: 오류 처리**: API 호출 실패, 데이터 없음 등의 오류 상황을 적절히 처리하고 사용자에게 안내 메시지를 보여줘야 한다.

**5. 비기능 요구사항**

* **NFR-01: 성능**: 일반적인 학명 조회 요청에 대해 5초 이내에 응답해야 한다 (캐시 히트 시 더 빠름).
* **NFR-02: 보안**: API 키(Gemini, Supabase Service Role Key)는 환경 변수 등을 통해 안전하게 관리되어야 한다.
* **NFR-03: 확장성**: 추후 다른 정보 소스(예: NCBI) 연동이나 추가 기능 구현이 용이한 구조여야 한다.
* **NFR-04: 사용성**: 초보 사용자도 쉽게 학명을 입력하고 결과를 이해할 수 있는 직관적인 UI/UX를 제공해야 한다.

**6. 릴리즈 기준 (예시)**

* **MVP (Minimum Viable Product)**: FR-01 ~ FR-04, FR-06 ~ FR-10 구현 완료. (WoRMS + Gemini + Supabase 캐싱 기본 기능)
* **Phase 2**: FR-05 (Wikipedia 연동) 구현 완료.

---

**4. 프로젝트 체크리스트**

프로젝트 진행을 위한 기본적인 체크리스트입니다.

---

**학명 정보 조회 서비스 - 프로젝트 체크리스트**

**Phase 0: 준비 및 환경 설정**

* [ ] Git 저장소 생성 및 초기 설정
* [ ] Python 개발 환경 설정 (가상환경 생성 권장: `python -m venv .venv`)
* [ ] FastAPI 프로젝트 구조 초기 설정
* [ ] Flutter 개발 환경 설정
* [ ] Supabase 프로젝트 생성 및 테이블 설계/생성
* [ ] 필요한 API 키 발급 (Gemini, Supabase)
* [ ] API 키 환경 변수 설정 방법 결정 및 문서화 (.env 파일 활용 등)
* [ ] 필요한 Python 라이브러리 설치 (`fastapi`, `uvicorn`, `requests`, `google-generativeai`, `supabase`, `python-dotenv`)
* [ ] 필요한 Flutter 패키지 추가 (`http`, `provider` 또는 `riverpod` 등 상태 관리)

**Phase 1: 백엔드 개발 (FastAPI)**

* [ ] FastAPI 기본 앱 설정 및 라우터 구성
* [ ] Supabase 클라이언트 연동 모듈 구현
* [ ] WoRMS API 호출 로직 구현
* [ ] Gemini API 호출 및 프롬프트 엔지니어링
* [ ] Supabase 캐시 조회/저장/업데이트 로직 구현
* [ ] 학명 조회 API 엔드포인트 구현 (/check-name/{scientific_name} 등)
* [ ] 오류 처리 로직 구현
* [ ] 단위 테스트 또는 통합 테스트 코드 작성 (선택 사항이지만 권장)
* [ ] API 문서 자동 생성 확인 (FastAPI 기본 기능 /docs)

**Phase 2: 프론트엔드 개발 (Flutter)**

* [ ] Flutter 프로젝트 생성 및 기본 구조 설정
* [ ] 학명 입력 UI 화면 디자인 및 구현
* [ ] 결과 표시 UI 화면 디자인 및 구현
* [ ] FastAPI 백엔드 API 호출 로직 구현 (http 클라이언트 사용)
* [ ] 상태 관리 설정 (로딩, 결과, 오류 상태)
* [ ] 사용자 입력 유효성 검사 (선택 사항)
* [ ] 화면 간 네비게이션 구현 (필요시)

**Phase 3: 연동 및 테스트**

* [ ] FastAPI 백엔드 로컬 실행 및 테스트
* [ ] Flutter 앱에서 로컬 백엔드 연동 테스트
* [ ] 주요 학명 케이스 테스트 (유효, 무효, 상위 분류군 등)
* [ ] 오류 상황 테스트 (API 키 오류, 네트워크 오류 등)
* [ ] 캐싱 로직 동작 확인 (반복 조회 시 속도 개선 확인)

**Phase 4: 배포 (선택 사항)**

* [ ] FastAPI 백엔드 배포 환경 선택 및 설정 (클라우드 서버, PaaS 등)
* [ ] Flutter 앱 빌드 및 배포 (앱 스토어, 웹 등)

**Phase 5: 기능 확장 (선택 사항)**

* [ ] Wikipedia 정보 연동 구현
* [ ] 주기적 업데이트 기능 구현 (별도 스케줄러 필요)
* [ ] 사용자 인증 기능 추가 (필요시)

---

**5. 초보자 테스트 고려**

네, 충분히 고려하겠습니다. 스크립트나 코드를 제공할 때, 터미널에서 쉽게 실행하고 결과를 확인할 수 있도록 구성하겠습니다. 특히 API 키 설정이나 라이브러리 설치 등 초보자가 어려움을 겪을 수 있는 부분에 대해서는 최대한 자세하고 명확하게 안내해 드리겠습니다. 지금 `worms.py` 스크립트도 터미널 실행을 기본으로 하고 있고, 앞으로 Supabase 연동 등을 추가할 때도 마찬가지로 진행하겠습니다.

**6. 현재 개발 방향성 검토**

**아주 좋은 방향입니다!** 특히 학습 목적이나 새로운 프로젝트 초기 단계에서는 지금처럼 핵심 기능을 작게 구현하고, 직접 테스트하며 이해도를 높인 다음, 점진적으로 기능을 확장하고 개선해 나가는 방식이 매우 효과적입니다.

* **장점**:
  * 각 단계별로 성취감을 느끼며 학습 동기를 유지할 수 있습니다.
  * 작은 단위로 문제를 해결하므로 복잡성이 낮아지고 디버깅이 용이합니다.
  * 구현 과정에서 새로운 아이디어나 개선점을 발견하고 유연하게 반영할 수 있습니다.
  * 처음부터 너무 거대한 시스템을 설계하는 부담을 줄일 수 있습니다.

지금처럼 WoRMS 연동 -> Gemini 연동 -> (이제 논의할) Supabase 연동 -> (향후) FastAPI/Flutter 앱 개발 순서로 진행하는 것은 기술 스택을 하나씩 익히고 전체 시스템을 구축해나가는 데 아주 적합한 방식입니다.

**다음 단계 진행 여부 확인**

자, 이제 위키피디아, LangGraph, PRD, 체크리스트, 개발 방향성에 대한 논의를 마쳤습니다. 이 내용을 바탕으로, **원래 요청하셨던 Supabase 연동 코드(캐싱 및 업데이트 로직)를 `worms.py`에 추가하는 작업을 계속 진행할까요?** 아니면 PRD나 체크리스트를 좀 더 구체화하거나 다른 부분을 먼저 진행하고 싶으신가요?
