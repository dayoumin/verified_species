# Species Verifier 개발 계획

## 🎯 현재 완료된 기능
- ✅ 3개 탭(해양생물, 미생물, COL) 통합 검증 시스템
- ✅ 파일 캐시 관리 시스템 (검증 완료/취소 시 자동 삭제)
- ✅ 취소 시 파일 캐시 삭제 기능
- ✅ 진행률 표시 개선
- ✅ 도움말 서식 개선 및 연락처 추가
- ✅ 텍스트 입력과 파일 입력 우선순위 명확화
- ✅ 심층분석 결과 "준비 중" 메시지 표시 (DeepSearch 기반 구조 준비)

## 🔧 즉시 개선 필요 사항
- 🔄 중단 기능 개선 (현재 불완전)
- 🔄 비동기와 동기 코드 혼재 문제 해결
- 🔄 결과 테이블 셀 선택 방식 개선 (전체 행 → 개별 셀)
- ✅ 심층분석 결과 "준비 중" 메시지 표시 완료
- 🔄 DeepSearch 심층분석 시스템 구현 (별도 팝업 화면)

## 🚀 향후 개발 계획

### Phase 1: 핵심 시스템 개선 (우선순위: 높음)

#### 1.1 AI 학명 자동 수정 시스템 🤖
- 🔄 Gemini API 기반 학명 오타 및 형식 오류 자동 감지
- 🔄 실시간 학명 제안 및 자동 수정 기능
- 🔄 사용자 승인 기반 수정 시스템 (팝업 확인)
- 🔄 학명 표준화 및 형식 검증
- 🔄 다국어 학명 입력 지원 (한글 → 라틴명 변환)

**AI 학명 수정 시스템 동작 방식:**
- **입력 검증:** 사용자가 학명 입력 시 AI가 즉시 분석
- **오류 감지:** 오타, 띄어쓰기, 대소문자, 형식 오류 등 감지
- **수정 제안:** 올바른 학명을 AI가 제안 (신뢰도 점수 포함)
- **사용자 확인:** 팝업창으로 "원본: Homo sapians → 수정: Homo sapiens" 확인
- **자동 적용:** 사용자 승인 시 수정된 학명으로 검증 진행
- **학습 기능:** 수정 이력을 DB에 저장하여 패턴 학습

**기술 스택:**
- Gemini API 1.5 Pro (학명 분석 및 교정)
- SQLite/Supabase (수정 이력 저장)
- 정규표현식 (기본 형식 검증)
- Fuzzy Matching (유사 학명 검색)

#### 1.2 코드 리팩토링 시스템 🔧
**목표:** 코드 중복 최소화, 유지보수성 향상, 가독성 및 효율성 개선

**1.2.1 파일 처리 로직 통합** (우선순위: 최고)
- 🔄 `_marine_file_browse()`, `_microbe_file_browse()`, `_col_file_browse()` → `_unified_file_browse()` 통합
- 🔄 `_process_file()`, `_process_microbe_file()`, `_process_col_file()` → `_unified_process_file()` 통합
- 🔄 `bridge.py`의 `process_file()`과 `process_microbe_file()` → `unified_process_file()` 통합
- 🔄 파일명 기반 분기 로직 제거, 파일 내용 기반 스마트 분석으로 변경
- 🔄 파일 형식별 파서 모듈화 (CSV, XLSX, TXT)

**1.2.2 백그라운드 검증 스레드 통합** (우선순위: 높음)
- 🔄 `_perform_verification()`, `_perform_microbe_verification()`, `_perform_col_verification()` → `_unified_verification()` 통합
- 🔄 취소 확인, 진행률 업데이트, 배치 처리 로직 중앙 집중화
- 🔄 검증 타입별 동적 라우팅 시스템 구현
- 🔄 공통 오류 처리 및 복구 로직 통합

**1.2.3 검색/검증 시작 로직 완전 통합** (우선순위: 중간)
- 🔄 `_marine_search()`, `_microbe_search()`, `_col_search()` 완전 제거
- 🔄 `_search_species()` 함수로 모든 탭 검색 로직 통합
- 🔄 탭별 콜백 시스템 단순화

**1.2.4 브릿지 모듈 개선** (우선순위: 중간)
- 🔄 복잡한 파일명 기반 분기 로직 제거
- 🔄 폴백 로직 정리 및 단순화
- 🔄 core 모듈과의 인터페이스 최적화

**기대 효과:**
- 코드 라인 수 30-40% 감소
- 새 기능 추가 시 개발 시간 50% 단축
- 버그 발생률 60% 감소
- 코드 리뷰 시간 40% 단축

#### 1.3 DeepSearch 심층분석 시스템 🔍
- 🔄 Supabase 기반 분석 결과 캐싱 시스템
- 🔄 Wikipedia, GBIF, EOL 등 다중 소스 통합 검색
- 🔄 AI 기반 생물학적 특성 요약 생성
- 🔄 관련 종 추천 시스템
- 🔄 분류학적 계통도 시각화

#### 1.4 성능 최적화 및 캐싱 시스템 ⚡
- 🔄 Supabase 기반 검증 결과 캐싱
- 🔄 중복 API 호출 방지 시스템
- 🔄 배경 검증 및 사전 로딩
- 🔄 네트워크 연결 최적화

### Phase 2: 사용자 경험 개선 (우선순위: 중간)

#### 2.1 고급 UI/UX 기능
- 🔄 드래그 앤 드롭 파일 업로드
- 🔄 실시간 검색 제안 (자동완성)
- 🔄 검증 히스토리 및 즐겨찾기
- 🔄 다크/라이트 테마 지원
- 🔄 사용자 설정 저장 및 복원

#### 2.2 데이터 시각화 및 분석
- 🔄 검증 결과 통계 대시보드
- 🔄 분류군별 분포 차트
- 🔄 검증 성공률 분석
- 🔄 Excel/PDF 고급 리포트 생성

#### 2.3 배치 처리 및 대용량 파일 지원
- 🔄 10,000개 이상 학명 처리 지원
- 🔄 백그라운드 처리 및 알림 시스템
- 🔄 처리 중단 및 재개 기능
- 🔄 진행률 상세 표시 및 예상 완료 시간

### Phase 3: 확장성 및 통합 (우선순위: 낮음)

#### 3.1 API 및 플러그인 시스템
- 🔄 RESTful API 제공
- 🔄 제3자 시스템 연동 지원
- 🔄 커스텀 검증 규칙 플러그인
- 🔄 외부 데이터베이스 연동

#### 3.2 다국어 및 접근성
- 🔄 영어, 일본어, 중국어 지원
- 🔄 접근성 표준 준수 (WCAG 2.1)
- 🔄 키보드 네비게이션 완전 지원
- 🔄 스크린 리더 호환성

#### 3.3 클라우드 및 협업 기능
- 🔄 클라우드 동기화
- 🔄 팀 협업 기능
- 🔄 검증 결과 공유 시스템
- 🔄 버전 관리 및 백업

## 🎯 리팩토링 우선순위 매트릭스

| 작업 | 복잡도 | 영향도 | 우선순위 | 예상 소요 시간 |
|------|--------|--------|----------|----------------|
| 파일 처리 통합 | 높음 | 매우 높음 | 1 | 2-3일 |
| 검증 스레드 통합 | 높음 | 높음 | 2 | 3-4일 |
| 검색 로직 완전 통합 | 중간 | 중간 | 3 | 1-2일 |
| 브릿지 모듈 개선 | 중간 | 중간 | 4 | 1-2일 |
| AI 학명 수정 | 높음 | 높음 | 5 | 5-7일 |

## 📋 Phase 1 상세 실행 계획

### 1단계: 파일 처리 로직 통합 (2-3일)
1. **공통 파일 브라우저 함수 생성**
   - `_unified_file_browse(tab_type: str)` 구현
   - 탭별 파일 타입 필터링 통합

2. **통합 파일 처리 함수 생성**
   - `_unified_process_file(file_path: str, tab_type: str)` 구현
   - 파일 형식별 파서 모듈화

3. **Bridge 모듈 통합**
   - `unified_process_file()` 함수 생성
   - 파일명 기반 분기 로직 제거

### 2단계: 백그라운드 검증 스레드 통합 (3-4일)
1. **통합 검증 함수 생성**
   - `_unified_verification(items: List, verification_type: str, use_realtime: bool)` 구현
   - 공통 취소 확인, 진행률 업데이트 로직 중앙화

2. **검증 타입별 라우터 구현**
   - 동적 bridge 함수 호출 시스템
   - 오류 처리 및 복구 로직 통합

### 3단계: 검색 로직 완전 통합 (1-2일)
1. **개별 검색 함수 제거**
   - `_marine_search()`, `_microbe_search()`, `_col_search()` 삭제
   - `_search_species()` 함수로 완전 통합

### 4단계: 브릿지 모듈 정리 (1-2일)
1. **폴백 로직 정리**
   - 불필요한 폴백 함수 제거
   - core 모듈 직접 호출로 단순화

## 🔧 기술적 고려사항

### 데이터베이스 최적화
- **인덱싱:** 검색 성능 최적화
- **파티셔닝:** 대용량 데이터 처리
- **백업 전략:** 데이터 안정성 확보

### API 통합 및 성능
- **Rate Limiting:** 외부 API 호출 제한 준수
- **Error Handling:** 네트워크 오류 처리 강화
- **Fallback 전략:** API 장애 시 대응 방안

### 보안 및 개인정보
- **데이터 암호화:** 민감 정보 보호
- **접근 제어:** 사용자 권한 관리
- **로그 관리:** 사용 기록 추적

## 💡 예상 효과

### 성능 향상
- **응답 시간:** 캐시된 결과 즉시 반환 (90% 이상 속도 향상)
- **서버 부하:** API 호출 횟수 대폭 감소
- **사용자 경험:** 빠른 검증 결과 제공

### 데이터 품질 향상
- **정확성:** 검증된 고품질 데이터 제공
- **완성도:** 기본 검증 + 심층 분석 정보
- **최신성:** 주기적 데이터 업데이트

### 연구 지원 강화
- **상세 정보:** 연구자들이 필요로 하는 깊이 있는 정보
- **참고자료:** 신뢰할 수 있는 출처 정보
- **데이터 활용:** 연구 목적 데이터 내보내기 지원

---
**개발 문의:** ecomarine@korea.kr
